(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8cf07b7e"],{"582f":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"container"},on:{mousemove:e.mouseMove}}),n("div",{style:{left:e.state.planePos.left,top:e.state.planePos.top,display:e.state.planeDisplay},attrs:{id:"plane"}},[n("p",[e._v("机柜名称："+e._s(e.state.curCabinet.name))]),n("p",[e._v("机柜温度："+e._s(e.state.curCabinet.temperature))]),n("p",[e._v(" 使用情况："+e._s(e.state.curCabinet.count)+" / "+e._s(e.state.curCabinet.capacity)+" ")])])])},i=[],s=n("2909"),r=(n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("99af"),n("159b"),n("d81d"),n("caad"),n("2532"),n("b0c0"),n("5a89")),c=n("4721"),o=n("34ad"),l={data:function(){return{mesh:null,camera:null,scene:null,renderer:null,controls:null,animationId:null,public:"",maps:null,cabinets:[],curCabinet:"",state:{planePos:{left:0,top:0},planeDisplay:"none",curCabinet:{name:"Loading...",temperature:0,capacity:0,count:0}}}},beforeDestroy:function(){cancelAnimationFrame(this.animationId)},mounted:function(){this.maps=new Map,this.crtTexture("cabinet-hover.jpg"),this.init()},methods:{init:function(){this.createScene(),this.loadGLTF(),this.createCamera(),this.createRender(),this.createControls(),this.render()},createScene:function(){this.scene=new r["eb"]},loadGLTF:function(){var e=this,t=new o["a"];t.load("".concat(this.public,"models_room/machineRoom.gltf"),(function(t){var n,a,i=t.scene.children;(n=console).log.apply(n,["children"].concat(Object(s["a"])(i))),i.forEach((function(t){var n=t.material,a=n.map,i=n.color;e.changeMat(t,a,i),t.name.includes("cabinet")&&e.cabinets.push(t)})),(a=e.scene).add.apply(a,Object(s["a"])(i))}))},createLight:function(){var e=new r["a"](16777215,.1);this.scene.add(e);var t=new r["jb"](16777215);t.position.set(150,150,150),t.castShadow=!0,this.scene.add(t)},createCamera:function(){var e=document.getElementById("container"),t=e.clientWidth,n=e.clientHeight,a=t/n;this.camera=new r["V"](45,a,.1,1e3),this.camera.position.set(0,10,15),this.camera.lookAt(0,0,0),this.scene.add(this.camera)},createRender:function(){var e=document.getElementById("container");this.renderer=new r["tb"]({antialias:!0,alpha:!0}),this.renderer.setSize(e.clientWidth,e.clientHeight),this.renderer.setClearColor(4144959,1),e.appendChild(this.renderer.domElement)},createControls:function(){this.controls=new c["a"](this.camera,this.renderer.domElement)},render:function(){this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.render)},changeMat:function(e,t,n){e.material=t?new r["K"]({map:this.crtTexture(t.name)}):new r["K"]({color:n})},crtTexture:function(e){var t=this.maps.get(e);return t||(t=(new r["nb"]).load("".concat(this.public,"models_room/").concat(e)),t.flipY=!1,t.wrapS=1e3,t.wrapT=1e3,this.maps.set(e,t)),t},selectCabinet:function(e,t){var n=this.cabinets,a=this.renderer,i=this.camera,s=this.maps,c=this.curCabinet,o=a.domElement,l=o.width,u=o.height,h=new r["cb"],d=new r["qb"];d.set(e/l*2-1,-t/u*2+1),h.setFromCamera(d,i);var m=h.intersectObjects(n)[0],p=m?m.object:null;if(c&&c!==p){var b=c.material;b.setValues({map:s.get("cabinet.jpg")})}if(p){if(this.onMouseMoveCabinet(e,t),p!==c){this.curCabinet=p;var f=p.material;f.setValues({map:s.get("cabinet-hover.jpg")}),this.onMouseOverCabinet(p)}}else c&&(this.curCabinet=null,this.onMouseOutCabinet())},mouseMove:function(e){var t=e.clientX,n=e.clientY;this.selectCabinet(t,n)},onMouseOverCabinet:function(e){console.log(e),this.state.planeDisplay="block"},onMouseMoveCabinet:function(e,t){console.log(e,t),this.state.planePos.left=e+"px",this.state.planePos.top=t+"px"},onMouseOutCabinet:function(){this.state.planeDisplay="none"},animate:function(){this.animationId=requestAnimationFrame(this.animate),console.log(this.animate,"132"),mesh.rotation.x+=.01,mesh.rotation.y+=.02,renderer.render(scene,camera)}}},u=l,h=(n("d10d"),n("2877")),d=Object(h["a"])(u,a,i,!1,null,"0bc6b484",null);t["default"]=d.exports},b6fb:function(e,t,n){},d10d:function(e,t,n){"use strict";n("b6fb")}}]);