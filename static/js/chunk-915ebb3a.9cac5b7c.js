(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-915ebb3a"],{13:function(e,n){},14:function(e,n){},15:function(e,n){},16:function(e,n){},17:function(e,n){},"8c61":function(e,n,t){"use strict";t.r(n);var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("pre",[e._v(e._s(e.previewContent))]),t("div",{ref:"preview"}),t("p",[e._v("图片")]),t("input",{attrs:{type:"file"},on:{change:e.previewImage}}),t("p",[e._v("文本")]),t("input",{attrs:{type:"file"},on:{change:e.previewText}}),t("p",[e._v("PDF")]),t("input",{attrs:{type:"file"},on:{change:e.previewPdf}}),t("p",[e._v("word,excel,ppt")]),t("input",{attrs:{type:"file"},on:{change:e.previewOffice}})])},a=[],i=(t("d3b7"),t("3ca3"),t("ddb0"),t("2b3d"),t("9861"),t("ace4"),t("5cc6"),t("907a"),t("9a8c"),t("a975"),t("735e"),t("c1ac"),t("d139"),t("3a7b"),t("d5d6"),t("82f8"),t("e91f"),t("60bd"),t("5f96"),t("3280"),t("3fcc"),t("ca91"),t("25a1"),t("cd26"),t("3c5d"),t("2954"),t("649e"),t("219c"),t("170b"),t("b39a"),t("72f7"),t("fa9e"),t("77d9"),t("07ac"),t("d81d"),t("b0c0"),t("159b"),t("c4e3")),c=t.n(i),o=t("c343"),f=t.n(o),l=t("9511"),u=t("0507"),p=t.n(u);l["GlobalWorkerOptions"].workerSrc=p.a;var v={name:"DocumentPreview",components:{},data:function(){return{file:null,previewType:null,previewContent:null,fileUrl:null,fileType:null,preview:null}},mounted:function(){this.preview=this.$refs.preview},methods:{previewImage:function(e){var n=e.target.files;if(n&&n.length>0){var t=n[0];this.previewContent=URL.createObjectURL(t)}},previewText:function(e){var n=this,t=e.target.files;if(console.log("文本---",e),t&&t.length>0){var r=t[0],a=new FileReader;a.onload=function(e){n.previewContent=e.target.result},a.readAsText(r)}},previewPdf:function(e){var n=this,t=e.target.files;if(t&&t.length>0){var r=t[0],a=new FileReader;a.onload=function(e){var t=new Uint8Array(e.target.result);l["getDocument"](t).promise.then((function(e){for(var t=e.numPages,r=1;r<=t;r++)e.getPage(r).then((function(e){var t=e.getViewport({scale:1}),r=document.createElement("canvas"),a=r.getContext("2d");r.height=t.height,r.width=t.width;var i={canvasContext:a,viewport:t};e.render(i).promise.then((function(){var e=r.toDataURL("image/png"),t=document.createElement("img");t.src=e,n.preview.appendChild(t)}))}))}))},a.readAsArrayBuffer(r)}},previewOffice:function(e){var n=this,t=e.target.files;if(t&&t.length>0){var r=t[0],a=new FileReader;a.onload=function(e){var t=new Uint8Array(e.target.result),r=new c.a;r.loadAsync(t).then((function(e){var t=Object.values(e.files);Promise.all(t.map((function(e){return e.async("arraybuffer").then((function(n){return{name:e.name,data:n}}))}))).then((function(e){var t={};e.forEach((function(e){t[e.name]=e.data})),f.a.convertToHtml({arrayBuffer:t["word/document.xml"]}).then((function(e){var t=document.createElement("div");t.innerHTML=e.value,n.preview.appendChild(t)}),(function(e){console.log(e)}))}))}))},a.readAsArrayBuffer(r)}}}},d=v,s=t("2877"),w=Object(s["a"])(d,r,a,!1,null,null,null);n["default"]=w.exports}}]);