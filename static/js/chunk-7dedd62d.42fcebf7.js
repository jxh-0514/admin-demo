(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dedd62d"],{"20ca":function(t,e,n){"use strict";function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=null;return function(){var a=this,i=arguments;n&&clearTimeout(n),n=setTimeout((function(){t.apply(a,i)}),e)}}n.d(e,"a",(function(){return a}))},"26a6":function(t,e,n){"use strict";n("566a")},"566a":function(t,e,n){},"91bf":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",{attrs:{gutter:10}},[n("el-col",{attrs:{span:6,xl:4,lg:6}},t._l(t.components,(function(e,a){return n("div",{key:a,staticClass:"component-item"},[n("div",{staticClass:"draggable-component",attrs:{draggable:"true"},on:{dragstart:function(n){return t.onDragStart(e,n)},dragend:function(n){return t.onDragEnd(e,n)}}},[n("img",{staticClass:"preview-image",attrs:{src:e.previewImage,alt:"Preview"}}),n("p",[t._v(t._s(e.name))])])])})),0),n("el-col",{attrs:{span:18,xl:20,lg:18}},[n("div",{attrs:{id:"content"}},[n("grid-layout",{ref:"gridlayout",attrs:{layout:t.layout,"col-num":12,"row-height":30,"is-draggable":!0,"is-resizable":!0,"vertical-compact":!0,"use-css-transforms":!0},on:{"update:layout":function(e){t.layout=e},"layout-ready":t.layoutReadyEvent}},t._l(t.layout,(function(e){return n("grid-item",{key:e.id,attrs:{x:e.x,y:e.y,w:e.w,h:e.h,i:e.i},on:{resized:function(n){return t.resizedEvent(e)}}},[n(e.n,{ref:"componentRef_"+e.n+"_"+e.i,refInFor:!0,tag:"component",attrs:{item:e}})],1)})),1)],1)])],1)],1)},i=[],r=(n("d3b7"),n("25f0"),n("b0c0"),n("99af"),n("159b"),n("7be8")),o=n("ecf5"),s={x:null,y:null},c={name:"editScreen",components:{GridLayout:r["GridLayout"],GridItem:r["GridItem"],BarChart:o["a"],LineChart:o["a"],PieChart:o["a"]},props:{},data:function(){return{layout:[],components:[{name:"BarChart",previewImage:"https://echarts.apache.org/examples/data/thumb/bar-simple.webp?_v_=1724900876815",component:"BarChart",chartType:"bar"},{name:"LineChart",previewImage:"https://echarts.apache.org/examples/data/thumb/line-simple.webp?_v_=1724900876815",component:"LineChart",chartType:"line"},{name:"PieChart",previewImage:"https://echarts.apache.org/examples/data/thumb/pie-simple.webp?_v_=1726707777817",component:"PieChart",chartType:"pie"}],contentEl:null,draggedComponent:null}},computed:{colNum:function(){return 12}},watch:{},beforeDestroy:function(){document.removeEventListener("dragover",this.updateMousePosition,!1),window.removeEventListener("resize",this.updateContentElement,!1),this.$store.dispatch("dragScreen/setLayout",this.layout)},created:function(){var t=this.$store.getters.layout;t&&(this.layout=t)},mounted:function(){this.updateContentElement(),document.addEventListener("dragover",this.updateMousePosition,!1),window.addEventListener("resize",this.updateContentElement,!1)},methods:{updateContentElement:function(){this.contentEl=document.getElementById("content")},updateMousePosition:function(t){s.x=t.clientX,s.y=t.clientY},isMouseInGrid:function(){var t=this.contentEl.getBoundingClientRect();return s.x>t.left&&s.x<t.right&&s.y>t.top&&s.y<t.bottom},onDragStart:function(t,e){this.draggedComponent=t},onDragEnd:function(t,e){if(this.isMouseInGrid()){var n=this.calculatePosition(e),a=n.x,i=n.y;console.log("拖拽结束---",t,e,a,i);var r=Date.now().toString();this.layout.push({x:a,y:i,w:4,h:3,i:r,n:t.name,config:t})}this.draggedComponent=null},calculatePosition:function(t){var e=this.contentEl.getBoundingClientRect(),n=t.clientX-e.left,a=t.clientY-e.top,i=Math.floor(n/e.width*(this.colNum||12)),r=Math.floor(a/e.height*(this.colNum||12));return{x:i,y:r}},resizedEvent:function(t){console.log("调整大小---",t.n,this.layout),this.$refs["componentRef_".concat(t.n,"_").concat(t.i)][0].resizeChart()},layoutReadyEvent:function(){var t=this;this.$nextTick((function(){t.layout.length>0&&t.layout.forEach((function(e){t.$refs["componentRef_".concat(e.n,"_").concat(e.i)][0].resizeChart()}))}))}}},u=c,l=(n("97ff"),n("2877")),h=Object(l["a"])(u,a,i,!1,null,"05dee683",null);e["default"]=h.exports},"97ff":function(t,e,n){"use strict";n("bf5b")},bf5b:function(t,e,n){},ecf5:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"chart",staticClass:"chart"})},i=[],r=n("313e"),o=n.n(r),s=n("20ca"),c={name:"BarChart",props:{item:{type:Object,default:function(){return{x:0,y:0,w:2,h:2,i:"BarChart",config:{name:"BarChart",previewImage:"https://echarts.apache.org/examples/data/thumb/bar-simple.webp?_v_=1724900876815",component:"BarChart",chartType:"bar"}}}}},data:function(){return{chartInstance:null,resizeHandler:null}},mounted:function(){var t=this;setTimeout((function(){t.initChart(),t.resizeHandler=t.resizeChart,window.addEventListener("resize",(function(){t.resizeChart()}))}),0)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler),this.chartInstance&&this.chartInstance.dispose()},methods:{initChart:function(){var t=this;this.chartInstance=o.a.init(this.$refs.chart),console.log("初始化",this.chartInstance),this.chartInstance.showLoading({text:"Loading...",color:"#c23531",textColor:"#fff",maskColor:"rgba(0, 0, 0, 0.5)",zlevel:0}),setTimeout((function(){t.updateChart(),t.chartInstance.hideLoading()}),2e3)},updateChart:function(){var t={title:{text:"大屏数据展示 - ".concat(this.item.n),left:"center",textStyle:{color:"#fff",fontSize:24}},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisLine:{lineStyle:{color:"#fff"}}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#fff"}},splitLine:{lineStyle:{color:"#555"}}},series:[{name:"Sales",type:this.item.config.chartType||"bar",data:[120,200,150,80,70,110,130]}],backgroundColor:"#2c343c"};this.chartInstance.setOption(t)},resizeChart:Object(s["a"])((function(){this.chartInstance&&(console.log("resize",this.chartInstance.id),this.chartInstance.resize())}),500)}},u=c,l=(n("26a6"),n("2877")),h=Object(l["a"])(u,a,i,!1,null,"07a95b30",null);e["a"]=h.exports}}]);